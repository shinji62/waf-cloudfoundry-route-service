{"body_filter":[{"pattern":"(?:<title>[^<]*?(?:\\b(?:(?:c(?:ehennemden|gi-telnet)|gamma web shell)\\b|imhabirligi phpftp)|(?:r(?:emote explorer|57shell)|aventis klasvayv|zehir)\\b|\\.::(?:news remote php shell injection::\\.| rhtools\\b)|ph(?:p(?:(?: commander|-terminal)\\b|remoteview)|vayv)|myshell)|\\b(?:(?:(?:microsoft windows\\b.{0,10}?\\bversion\\b.{0,20}?\\(c\\) copyright 1985-.{0,10}?\\bmicrosoft corp|ntdaddy v1\\.9 - obzerve \\| fux0r inc)\\.|(?:www\\.sanalteror\\.org - indexer and read|haxplor)er|php(?:konsole| shell)|c99shell)\\b|aventgrup\\.<br>))","id":"950922","operator":"REGEX","action":"DENY","opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"value":"1","col":"tx","inc":1,"key":"trojan_score"},{"key":"anomaly_score","inc":1,"value":"%{tx.error_anomaly_score}","col":"tx"},{"key":"%{rule","col":"tx","value":"%{matched_var}"}]},"description":"Backdoor access","vars":[{"type":"RESPONSE_BODY"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"description":"Zope Information Leakage","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"RESPONSE_BODY"}],"opts":{"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"col":"tx","value":"%{tx.error_anomaly_score}","key":"outbound_anomaly_score","inc":1},{"col":"tx","value":"%{tx.error_anomaly_score}","inc":1,"key":"anomaly_score"},{"key":"%{rule","col":"tx","value":"%{tx.0}"}]},"action":"DENY","operator":"REGEX","pattern":"<h2>Site Error<\\/h2>.{0,20}<p>An error was encountered while publishing this resource\\.","id":"970007"},{"action":"DENY","opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"inc":1,"key":"outbound_anomaly_score","value":"%{tx.error_anomaly_score}","col":"tx"},{"value":"%{tx.error_anomaly_score}","col":"tx","inc":1,"key":"anomaly_score"},{"col":"tx","value":"%{tx.0}","key":"%{rule"}]},"operator":"REGEX","id":"970008","pattern":"\\bThe error occurred in\\b.{0,100}: line\\b.{0,1000}\\bColdFusion\\b.*?\\bStack Trace \\(click to expand\\)","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"RESPONSE_BODY"}],"description":"Cold Fusion Information Leakage"},{"id":"970009","operator":"REGEX","pattern":"<b>Warning<\\/b>.{0,100}?:.{0,1000}?\\bon line\\b","opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"col":"tx","value":"%{tx.error_anomaly_score}","inc":1,"key":"outbound_anomaly_score"},{"value":"%{tx.error_anomaly_score}","col":"tx","inc":1,"key":"anomaly_score"},{"col":"tx","value":"%{tx.0}","key":"%{rule"}]},"action":"DENY","description":"PHP Information Leakage","vars":[{"type":"RESPONSE_BODY"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"RESPONSE_BODY"}],"description":"ISA server existence revealed","action":"DENY","opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"inc":1,"key":"outbound_anomaly_score","value":"%{tx.error_anomaly_score}","col":"tx"},{"value":"%{tx.error_anomaly_score}","col":"tx","inc":1,"key":"anomaly_score"},{"key":"%{rule","value":"%{tx.0}","col":"tx"}]},"pattern":"\\b403 Forbidden\\b.*?\\bInternet Security and Acceleration Server\\b","operator":"REGEX","id":"970010"},{"pattern":"<o:documentproperties>","operator":"REGEX","id":"970012","opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"inc":1,"key":"outbound_anomaly_score","col":"tx","value":"%{tx.error_anomaly_score}"},{"inc":1,"key":"anomaly_score","col":"tx","value":"%{tx.error_anomaly_score}"},{"key":"%{rule","value":"%{tx.0}","col":"tx"}]},"action":"DENY","vars":[{"type":"RESPONSE_BODY"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","description":"Microsoft Office document properties leakage"},{"description":"ASP/JSP source code leakage","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"RESPONSE_BODY"}],"action":"CHAIN","id":"970903","pattern":"\\<\\%","operator":"REGEX"},{"vars":[{"type":"RESPONSE_BODY"}],"id":"970903","operator":"REGEX","pattern":"!(?:\\b(?:(?:i(?:nterplay|hdr|d3)|m(?:ovi|thd)|r(?:ar!|iff)|(?:ex|jf)if|f(?:lv|ws)|varg|cws)\\b|gif)|B(?:%pdf|\\.ra)\\b)","opts":{"setvar":[{"col":"tx","value":"%{rule.msg}","key":"msg"},{"inc":1,"key":"outbound_anomaly_score","col":"tx","value":"%{tx.error_anomaly_score}"},{"key":"anomaly_score","inc":1,"col":"tx","value":"%{tx.error_anomaly_score}"},{"value":"%{tx.0}","col":"tx","key":"%{rule"}]},"action":"DENY"},{"operator":"REGEX","id":"970016","pattern":"<cf","opts":{"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"value":"%{tx.error_anomaly_score}","col":"tx","inc":1,"key":"outbound_anomaly_score"},{"value":"%{tx.error_anomaly_score}","col":"tx","inc":1,"key":"anomaly_score"},{"value":"%{tx.0}","col":"tx","key":"%{rule"}]},"action":"DENY","vars":[{"type":"RESPONSE_BODY"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","description":"Cold Fusion source code leakage"},{"action":"DENY","opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"key":"outbound_anomaly_score","inc":1,"col":"tx","value":"%{tx.error_anomaly_score}"},{"value":"%{tx.error_anomaly_score}","col":"tx","key":"anomaly_score","inc":1},{"value":"%{tx.0}","col":"tx","key":"%{rule"}]},"pattern":"^5\\d{2}$","operator":"REGEX","id":"970901","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"STATUS"}],"description":"The application is not available"},{"description":"The application is not available","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"RESPONSE_BODY"}],"action":"DENY","opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"key":"outbound_anomaly_score","inc":1,"value":"%{tx.error_anomaly_score}","col":"tx"},{"value":"%{tx.error_anomaly_score}","col":"tx","key":"anomaly_score","inc":1},{"key":"%{rule","value":"%{tx.0}","col":"tx"}]},"id":"970118","operator":"REGEX","pattern":"(?:Microsoft OLE DB Provider for SQL Server(?:<\\/font>.{1,20}?error '800(?:04005|40e31)'.{1,40}?Timeout expired| \\(0x80040e31\\)<br>Timeout expired<br>)|<h1>internal server error<\\/h1>.*?<h2>part of the server has crashed or it has a configuration error\\.<\\/h2>|cannot connect to the server: timed out)"},{"description":"WebLogic information disclosure","vars":[{"type":"STATUS"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","pattern":"^500$","id":"970021","operator":"REGEX","action":"CHAIN"},{"id":"970021","pattern":"<title>JSP compile error<\\/title>","operator":"REGEX","vars":[{"type":"RESPONSE_BODY"}],"opts":{"setvar":[{"col":"tx","value":"%{rule.msg}","key":"msg"},{"inc":1,"key":"outbound_anomaly_score","col":"tx","value":"%{tx.error_anomaly_score}"},{"value":"%{tx.error_anomaly_score}","col":"tx","inc":1,"key":"anomaly_score"},{"key":"%{rule","value":"%{tx.0}","col":"tx"}]},"action":"DENY"},{"action":"CHAIN","pattern":"href\\s?=[\\s\\\"\\']*[A-Za-z]\\:\\x5c([^\\\"\\']+)","id":"970011","operator":"REGEX","description":"File or Directory Names Leakage","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"RESPONSE_BODY"}]},{"action":"DENY","opts":{"transform":["lowercase"],"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"inc":1,"key":"outbound_anomaly_score","value":"%{tx.error_anomaly_score}","col":"tx"},{"key":"anomaly_score","inc":1,"value":"%{tx.error_anomaly_score}","col":"tx"},{"value":"%{tx.0}","col":"tx","key":"%{rule"}]},"vars":[{"storage":1,"type":"TX","parse":{"specific":"1"}}],"id":"970011","pattern":"!program files\\x5cmicrosoft office\\x5c(?:office|templates)","operator":"REGEX"},{"opts":{"nolog":1,"transform":["html_decode","lowercase"]},"action":"IGNORE","id":"981177","pattern":["iframe"],"operator":"PM","skip_after":"END_IFRAME_CHECK","op_negated":1,"vars":[{"type":"RESPONSE_BODY"}]},{"opts":{"transform":["replace_comments"],"setvar":[{"col":"tx","value":"%{rule.msg}","key":"msg"},{"col":"tx","value":"%{tx.warning_anomaly_score}","key":"outbound_anomaly_score","inc":1},{"key":"anomaly_score","inc":1,"value":"%{tx.warning_anomaly_score}","col":"tx"},{"col":"tx","value":"%{tx.0}","key":"%{rule"}]},"action":"DENY","id":"981000","pattern":"<\\W*iframe[^>]+?\\b(?:width|height)\\b\\W*?=\\W*?[\\\"']?[^\\\"'1-9]*?(?:(?:20|1?\\d(?:\\.\\d*)?)(?![\\d%.])|[0-3](?:\\.\\d*)?%)","operator":"REGEX","description":"Possibly malicious iframe tag in output","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"RESPONSE_BODY"}]},{"description":"Possibly malicious iframe tag in output","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"RESPONSE_BODY"}],"opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"inc":1,"key":"outbound_anomaly_score","value":"%{tx.error_anomaly_score}","col":"tx"},{"value":"%{tx.error_anomaly_score}","col":"tx","key":"anomaly_score","inc":1},{"key":"%{rule","value":"%{tx.0}","col":"tx"}],"transform":["replace_comments"]},"action":"DENY","pattern":"<\\W*iframe[^>]+?\\bstyle\\W*?=\\W*?[\\\"']?\\W*?\\bdisplay\\b\\W*?:\\W*?\\bnone\\b","id":"981001","operator":"REGEX"},{"operator":"REGEX","id":"981003","pattern":"(?i:<\\s*IFRAME\\s*?[^>]*?src=\\\"javascript:)","action":"DENY","opts":{"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"col":"tx","value":"%{tx.error_anomaly_score}","key":"outbound_anomaly_score","inc":1},{"inc":1,"key":"anomaly_score","value":"%{tx.error_anomaly_score}","col":"tx"},{"col":"tx","value":"%{tx.0}","key":"%{rule"}]},"description":"Malicious iframe+javascript tag in output","vars":[{"type":"RESPONSE_BODY"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"action":"DENY","opts":{"setvar":[{"col":"tx","value":"%{rule.msg}","key":"msg"},{"value":"%{tx.critical_anomaly_score}","col":"tx","key":"outbound_anomaly_score","inc":1},{"col":"tx","value":"%{tx.critical_anomaly_score}","inc":1,"key":"anomaly_score"},{"value":"%{tx.0}","col":"tx","key":"%{rule"}]},"pattern":"(?i)(String\\.fromCharCode\\(.*?){4,}","id":"981004","operator":"REGEX","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"RESPONSE_BODY"}],"description":"Potential Obfuscated Javascript in Output - Excessive fromCharCode"},{"description":"Potential Obfuscated Javascript in Output - Eval+Unescape","vars":[{"type":"RESPONSE_BODY"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","id":"981005","operator":"REGEX","pattern":"(?i)(eval\\(.{0,15}unescape\\()","opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"col":"tx","value":"%{tx.critical_anomaly_score}","key":"outbound_anomaly_score","inc":1},{"col":"tx","value":"%{tx.critical_anomaly_score}","key":"anomaly_score","inc":1},{"key":"%{rule","col":"tx","value":"%{tx.0}"}]},"action":"DENY"},{"vars":[{"type":"RESPONSE_BODY"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","description":"Potential Obfuscated Javascript in Output - Unescape","operator":"REGEX","pattern":"(?i)(var[^=]+=\\s*unescape\\s*;)","id":"981006","opts":{"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"inc":1,"key":"outbound_anomaly_score","value":"%{tx.critical_anomaly_score}","col":"tx"},{"key":"anomaly_score","inc":1,"value":"%{tx.critical_anomaly_score}","col":"tx"},{"key":"%{rule","value":"%{tx.0}","col":"tx"}]},"action":"DENY"},{"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"RESPONSE_BODY"}],"description":"Potential Obfuscated Javascript in Output - Heap Spray","opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"value":"%{tx.critical_anomaly_score}","col":"tx","inc":1,"key":"outbound_anomaly_score"},{"inc":1,"key":"anomaly_score","col":"tx","value":"%{tx.critical_anomaly_score}"},{"col":"tx","value":"%{tx.0}","key":"%{rule"}]},"action":"DENY","pattern":"(?i:%u0c0c%u0c0c|%u9090%u9090|%u4141%u4141)","id":"981007","operator":"REGEX"},{"opts":{"nolog":1,"transform":["html_decode"]},"action":"IGNORE","pattern":["<TITLE>Index of","><br>","<title>Index ofMicrosoft VBScript runtime (0x8","error '800","Application uses a value of the wrong type for the current operation","Microsoft VBScript compilation (0x8","Microsoft VBScript compilation error","Microsoft .NET Framework Version:","A trappable error occurred in an external object. The script cannot continue running","rror","Microsoft VBScript runtime Error",">Syntax error in string in query expression","ADODB.Command","Object required: '","<b>Version Information:</b> does not match with a table name or alias name used in the query","You have an error in your SQL syntax near '","Wora_","Wpg_","select list because it is not contained in either an aggregate function or the GROUP BY clause","Syntax error converting the ","supplied argument is not a valid MS SQL","supplied argument is not a valid Oracle","Unclosed quotation mark before the character string","Warning: mysql_connect():","Unable to connect to PostgreSQL server:","SQL Server does not exist or access denied","supplied argument is not a valid PostgreSQL result","Microsoft OLE DB Provider for ","Access Database Engine","Either BOF or EOF is True, or the current record has been deleted","supplied argument is not a valid ODBC","supplied argument is not a valid MySQL","WRoadhouse","You have an error in your SQL syntax","error '800a01b8'"," data type as an argument.","SQL syntax","select list because it is not contained in an aggregate function and there is no GROUP BY clause","' in sysservers. execute sp_addlinkedserver","incorrect syntax near These statistics were produced by PeLAB","This analysis was produced by","These statistics were produced by getstats","This report was generated by WebLog","ebalizer","This summary was generated byfgets","ftp_put","ftp_nb_put","fopen","readdir","$_post","ftp_nb_fput","ftp_get","scandir","readgzfile","proc_open","ftp_fput","fwrite","session_start","gzopen","$_session","move_uploaded_file","readfile","ftp_fget","gzencode","bzopen","gzread","call_user_func","ftp_nb_fget","$_get","fscanf","fread","fgetc","ftp_nb_get","fgetss","gzwrite","gzcompressserver.urlencode","server.createobject","scripting.filesystemobject","server.execute","wscript.shell","<jsp:",".createtextfile",".addheader","wscript.network","javax.servlet",".loadfromfile","server.mappath","vbscript.encode","server.htmlencode","response.write","response.binarywrite",".getfile"],"operator":"PM","id":"981178","skip_after":"END_OUTBOUND_CHECK","op_negated":1,"vars":[{"type":"RESPONSE_BODY"}]},{"id":"970014","operator":"REGEX","pattern":"(?:\\b(?:(?:s(?:erver\\.(?:(?:(?:htm|ur)lencod|execut)e|createobject|mappath)|cripting\\.filesystemobject)|(?:response\\.(?:binary)?writ|vbscript\\.encod)e|wscript\\.(?:network|shell))\\b|javax\\.servlet)|\\.(?:(?:(?:createtex|ge)t|loadfrom)file|addheader)\\b|<jsp:)","action":"DENY","opts":{"setvar":[{"col":"tx","value":"%{rule.msg}","key":"msg"},{"col":"tx","value":"%{tx.error_anomaly_score}","key":"outbound_anomaly_score","inc":1},{"inc":1,"key":"anomaly_score","value":"%{tx.error_anomaly_score}","col":"tx"},{"value":"%{tx.0}","col":"tx","key":"%{rule"}]},"vars":[{"type":"RESPONSE_BODY"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","description":"ASP/JSP source code leakage"},{"pattern":"(?:\\b(?:f(?:tp_(?:nb_)?f?(?:ge|pu)t|get(?:s?s|c)|scanf|write|open|read)|gz(?:(?:encod|writ)e|compress|open|read)|s(?:ession_start|candir)|read(?:(?:gz)?file|dir)|move_uploaded_file|(?:proc_|bz)open|call_user_func)|\\$_(?:(?:pos|ge)t|session))\\b","id":"970015","operator":"REGEX","action":"DENY","opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"inc":1,"key":"outbound_anomaly_score","value":"%{tx.error_anomaly_score}","col":"tx"},{"col":"tx","value":"%{tx.error_anomaly_score}","key":"anomaly_score","inc":1},{"col":"tx","value":"%{tx.0}","key":"%{rule"}]},"vars":[{"type":"RESPONSE_BODY"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","description":"PHP source code leakage"},{"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"RESPONSE_BODY"}],"description":"PHP source code leakage","action":"CHAIN","id":"970902","pattern":"<\\?(?!xml)","operator":"REGEX"},{"pattern":"!(?:\\b(?:(?:i(?:nterplay|hdr|d3)|m(?:ovi|thd)|r(?:ar!|iff)|(?:ex|jf)if|f(?:lv|ws)|varg|cws)\\b|gif)|B(?:%pdf|\\.ra)\\b)","id":"970902","operator":"REGEX","vars":[{"type":"RESPONSE_BODY"}],"action":"DENY","opts":{"setvar":[{"col":"tx","value":"%{rule.msg}","key":"msg"},{"inc":1,"key":"outbound_anomaly_score","col":"tx","value":"%{tx.error_anomaly_score}"},{"key":"anomaly_score","inc":1,"col":"tx","value":"%{tx.error_anomaly_score}"},{"key":"%{rule","col":"tx","value":"%{tx.0}"}]}},{"operator":"REGEX","id":"970002","pattern":"\\b(?:Th(?:is (?:summary was generated by.{0,100}?(?:w(?:ebcruncher|wwstat)|analog|Jware)|analysis was produced by.{0,100}?(?:calamaris|EasyStat|analog)|report was generated by WebLog)|ese statistics were produced by (?:getstats|PeLAB))|[gG]enerated by.{0,100}?[Ww]ebalizer)\\b","action":"DENY","opts":{"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"key":"outbound_anomaly_score","inc":1,"col":"tx","value":"%{tx.error_anomaly_score}"},{"value":"%{tx.error_anomaly_score}","col":"tx","inc":1,"key":"anomaly_score"},{"col":"tx","value":"%{tx.0}","key":"%{rule"}]},"description":"Statistics Information Leakage","vars":[{"type":"RESPONSE_BODY"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}"},{"description":"SQL Information Leakage","vars":[{"type":"RESPONSE_BODY"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","operator":"REGEX","pattern":"(?:\\b(?:(?:s(?:elect list because it is not contained in (?:an aggregate function and there is no|either an aggregate function or the) GROUP BY clause|upplied argument is not a valid (?:PostgreSQL result|O(?:racle|DBC)|M(?:S |y)SQL))|S(?:yntax error converting the \\w+ value .*? to a column of data type|QL Server does not exist or access denied)|Either BOF or EOF is True, or the current record has been deleted(. Requested|; the operation)|The column prefix .{0,50}? does not match with a table name or alias name used in the query|Could not find server '\\w+' in sysservers\\. execute sp_addlinkedserver)\\b|microsoft jet database engine error '8|Microsoft Access Driver|JET Database Engine|Access Database Engine|ORA-\\d{5}: |ORA-[0-9][0-9][0-9][0-9]|Oracle error|Oracle.*?Driver|Warning.*?Woci_.*?|Warning.*?Wora_.*?|Un(?:closed quotation mark before the character string\\b|able to connect to PostgreSQL server:)|PostgreSQL query failed:|PostgreSQL.*?ERROR|Warning.*?Wpg_.*?|valid PostgreSQL result|Npgsql.|(?:Microsoft OLE DB Provider for .{0,30} [eE]rror |error '800a01b8)'|You have an error in your SQL syntax(?: near ')?|incorrect syntax near (?:\\'|the\\b|\\@\\@error\\b)|cannot take a \\w+ data type as an argument\\.|Warning: mysql_connect\\(\\):)|\\[Microsoft\\]\\[ODBC |Driver.*? SQL[-_ ]*Server|OLE DB.*? SQL Server|(W|A)SQL Server.*?Driver|Warning.*?mssql_.*?|(W|A)SQL Server.*?[0-9a-fA-F]{8}|Exception Details:.*?WSystem.Data.SqlClient.|Exception Details:.*?WRoadhouse.Cms.|SQL syntax.*?MySQL|Warning.*?mysql_.*?|valid MySQL result|MySqlClient.|SQLite\\/JDBCDriver|SQLite.Exception|System.Data.SQLite.SQLiteException|Warning.*?sqlite_.*?|Warning.*?SQLite3::)","id":"970003","opts":{"setvar":[{"col":"tx","value":"%{rule.msg}","key":"msg"},{"inc":1,"key":"outbound_anomaly_score","col":"tx","value":"%{tx.critical_anomaly_score}"},{"inc":1,"key":"anomaly_score","col":"tx","value":"%{tx.critical_anomaly_score}"},{"key":"%{rule","col":"tx","value":"%{tx.0}"}]},"action":"DENY"},{"description":"IIS Information Leakage","vars":[{"type":"RESPONSE_BODY"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","operator":"REGEX","pattern":"(?:\\b(?:A(?:DODB\\.Command\\b.{0,100}?\\b(?:Application uses a value of the wrong type for the current operation\\b|error')| trappable error occurred in an external object\\. The script cannot continue running\\b)|Microsoft VBScript (?:compilation (?:\\(0x8|error)|runtime (?:Error|\\(0x8))\\b|Object required: '|error '800)|<b>Version Information:<\\/b>(?:&nbsp;|\\s)(?:Microsoft \\.NET Framework|ASP\\.NET) Version:|>error 'ASP\\b|An Error Has Occurred|>Syntax error in string in query expression|\\/[Ee]rror[Mm]essage\\.aspx?\\?[Ee]rror\\b)","id":"970004","action":"DENY","opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"key":"outbound_anomaly_score","inc":1,"value":"%{tx.error_anomaly_score}","col":"tx"},{"col":"tx","value":"%{tx.error_anomaly_score}","key":"anomaly_score","inc":1},{"col":"tx","value":"%{tx.0}","key":"%{rule"}]}},{"id":"970904","operator":"REGEX","pattern":"!^404$","action":"CHAIN","vars":[{"type":"STATUS"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","description":"IIS Information Leakage"},{"opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"value":"%{tx.error_anomaly_score}","col":"tx","key":"outbound_anomaly_score","inc":1},{"inc":1,"key":"anomaly_score","col":"tx","value":"%{tx.error_anomaly_score}"},{"key":"%{rule","col":"tx","value":"%{tx.0}"}]},"action":"DENY","operator":"REGEX","id":"970904","pattern":"\\bServer Error in.{0,50}?\\bApplication\\b","vars":[{"type":"RESPONSE_BODY"}]},{"pattern":"(?:<(?:TITLE>Index of.*?<H|title>Index of.*?<h)1>Index of|>\\[To Parent Directory\\]<\\/[Aa]><br>)","id":"970013","operator":"REGEX","action":"DENY","opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"col":"tx","value":"%{tx.error_anomaly_score}","key":"outbound_anomaly_score","inc":1},{"key":"anomaly_score","inc":1,"col":"tx","value":"%{tx.error_anomaly_score}"},{"value":"%{tx.0}","col":"tx","key":"%{rule"}]},"vars":[{"type":"RESPONSE_BODY"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","description":"Directory Listing"},{"vars":[{"storage":1,"type":"TX","parse":{"specific":"OUTBOUND_ANOMALY_SCORE"}}],"logdata":"Last Matched Data: %{matched_var}","description":"Outbound Anomaly Score Exceeded (score %{TX.OUTBOUND_ANOMALY_SCORE}): Last Matched Message: %{tx.msg}","id":"981200","pattern":"%{tx.outbound_anomaly_score_level}","operator":"GREATER_EQ","action":"CHAIN"},{"id":"981200","operator":"EQUALS","pattern":"on","vars":[{"parse":{"specific":"ANOMALY_SCORE_BLOCKING"},"storage":1,"type":"TX"}],"opts":{"parsepattern":1},"action":"CHAIN"},{"id":"981200","pattern":"(.*)","operator":"REGEX","vars":[{"parse":{"specific":"/^\\d/"},"storage":1,"type":"TX"}],"action":"DENY"},{"description":"Correlated Successful Attack Identified: (Total Score: %{tx.anomaly_score}, SQLi=%{TX.SQL_INJECTION_SCORE}, XSS=%{TX.XSS_SCORE}) Inbound Attack (%{tx.inbound_tx_msg} - Inbound Anomaly Score: %{TX.INBOUND_ANOMALY_SCORE}) + Outbound Data Leakage (%{tx.msg} - Outbound Anomaly Score: %{TX.OUTBOUND_ANOMALY_SCORE})","vars":[{"storage":1,"length":1,"type":"TX","parse":{"specific":"'/LEAKAGE\\\\\\/ERRORS/'"}}],"action":"CHAIN","opts":{},"operator":"GREATER_EQ","pattern":1,"id":"981201"},{"operator":"GREATER_EQ","id":"981201","pattern":1,"vars":[{"type":"TX","storage":1,"length":1,"parse":{"specific":"'/WEB_ATTACK/'"}}],"action":"IGNORE","skip_after":"END_CORRELATION"},{"vars":[{"type":"TX","storage":1,"length":1,"parse":{"specific":"'/AVAILABILITY\\\\\\/APP_NOT_AVAIL/'"}}],"description":"Correlated Attack Attempt Identified: (Total Score: %{tx.anomaly_score}, SQLi=%{TX.SQL_INJECTION_SCORE}, XSS=%{TX.XSS_SCORE}) Inbound Attack (%{tx.inbound_tx_msg} Inbound Anomaly Score: %{TX.INBOUND_ANOMALY_SCORE}) + Outbound Application Error (%{tx.msg} - Outbound Anomaly Score: %{TX.OUTBOUND_ANOMALY_SCORE})","pattern":1,"operator":"GREATER_EQ","id":"981202","action":"CHAIN","opts":{}},{"skip_after":"END_CORRELATION","vars":[{"storage":1,"length":1,"type":"TX","parse":{"specific":"'/WEB_ATTACK/'"}}],"id":"981202","pattern":1,"operator":"GREATER_EQ","action":"IGNORE"},{"vars":[{"parse":{"specific":"INBOUND_ANOMALY_SCORE"},"storage":1,"type":"TX"}],"description":"Inbound Anomaly Score (Total Inbound Score: %{TX.INBOUND_ANOMALY_SCORE}, SQLi=%{TX.SQL_INJECTION_SCORE}, XSS=%{TX.XSS_SCORE}): %{tx.inbound_tx_msg}","id":"981203","operator":"GREATER","pattern":0,"action":"CHAIN","opts":{"nolog":1}},{"id":"981203","operator":"LESS","pattern":"%{tx.inbound_anomaly_score_level}","vars":[{"storage":1,"type":"TX","parse":{"specific":"INBOUND_ANOMALY_SCORE"}}],"action":"IGNORE","skip_after":"END_CORRELATION"},{"action":"IGNORE","opts":{"nolog":1},"pattern":"%{tx.inbound_anomaly_score_level}","id":"981204","operator":"GREATER_EQ","description":"Inbound Anomaly Score Exceeded (Total Inbound Score: %{TX.INBOUND_ANOMALY_SCORE}, SQLi=%{TX.SQL_INJECTION_SCORE}, XSS=%{TX.XSS_SCORE}): %{tx.inbound_tx_msg}","vars":[{"type":"TX","storage":1,"parse":{"specific":"INBOUND_ANOMALY_SCORE"}}]},{"vars":[{"type":"TX","storage":1,"parse":{"specific":"OUTBOUND_ANOMALY_SCORE"}}],"description":"Outbound Anomaly Score Exceeded (score %{TX.OUTBOUND_ANOMALY_SCORE}): %{tx.msg}","action":"IGNORE","opts":{"nolog":1},"pattern":"%{tx.outbound_anomaly_score_level}","id":"981205","operator":"GREATER_EQ"}],"access":[{"action":"DENY","operator":"REGEX","id":null,"pattern":"!^(?i:(?:[a-z]{3,10}\\s+(?:\\w{3,7}?://[\\w\\-\\./]*(?::\\d+)?)?/[^?#]*(?:\\?[^#\\s]*)?(?:#[\\S]*)?|connect (?:\\d{1,3}\\.){3}\\d{1,3}\\.?(?::\\d+)?|options \\*)\\s+[\\w\\./]+|get /[^?#]*(?:\\?[^#\\s]*)?(?:#[\\S]*)?)$","vars":[{"type":"REQUEST_LINE"}],"description":"Invalid HTTP Request Line"},{"description":"Content-Length HTTP header is not numeric.","action":"DENY","pattern":"!^\\d+$","id":null,"operator":"REGEX","vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"Content-Length"}}]},{"action":"DENY","vars":[{"type":"METHOD"}],"operator":"REGEX","id":null,"pattern":"^(?:GET|HEAD)$","description":"GET or HEAD Request with Body Content."},{"vars":[{"parse":{"specific":"Content-Length"},"type":"REQUEST_HEADERS"}],"id":null,"operator":"REGEX","pattern":"!^0?$","action":"DENY"},{"description":"POST request missing Content-Length Header.","action":"DENY","id":null,"pattern":"^POST$","operator":"REGEX","vars":[{"type":"METHOD"}]},{"action":"CHAIN","operator":"REGEX","id":null,"pattern":"^HTTP/1\\.0$","vars":[{"type":"PROTOCOL"}]},{"action":"DENY","operator":"EQUALS","id":null,"pattern":0,"vars":[{"parse":{"specific":"Content-Length"},"length":1,"type":"REQUEST_HEADERS"}]},{"description":"Invalid Use of Identity Encoding.","action":"DENY","id":null,"pattern":"^Identity$","operator":"REGEX","vars":[{"parse":{"specific":"Content-Encoding"},"type":"REQUEST_HEADERS"}]},{"description":"Expect Header Not Allowed for HTTP 1.0.","opts":{"parsepattern":1},"action":"DENY","operator":"STR_CONTAINS","id":null,"pattern":"100-continue","vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"Expect"}}]},{"opts":{"parsepattern":1},"action":"DENY","id":null,"operator":"EQUALS","pattern":"HTTP/1.0","vars":[{"type":"PROTOCOL"}]},{"id":"958291","pattern":"^bytes=0-","operator":"REGEX","opts":{"parsepattern":1,"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"key":"anomaly_score","inc":1,"col":"tx","value":"%{tx.warning_anomaly_score}"},{"col":"tx","value":"%{matched_var}","key":"%{rule"}]},"action":"DENY","vars":[{"parse":{"specific":"Range"},"type":"REQUEST_HEADERS"}],"logdata":"%{matched_var}","description":"Range: field exists and begins with 0."},{"operator":"REGEX","pattern":"(\\d+)\\-(\\d+)\\,","id":"958230","opts":{"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"inc":1,"key":"anomaly_score","col":"tx","value":"%{tx.warning_anomaly_score}"},{"key":"%{rule","value":"%{matched_var}","col":"tx"}]},"action":"CHAIN","vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"Range"}},{"type":"REQUEST_HEADERS","parse":{"specific":"Request-Range"}}],"logdata":"%{matched_var}","description":"Range: Invalid Last Byte Value."},{"op_negated":1,"action":"DENY","id":"958230","pattern":"%{tx.1}","operator":"GREATER_EQ","vars":[{"type":"TX","storage":1,"parse":{"specific":"2"}}]},{"description":"Range: Too many fields","logdata":"%{matched_var}","vars":[{"parse":{"specific":"Range"},"type":"REQUEST_HEADERS"},{"parse":{"specific":"Request-Range"},"type":"REQUEST_HEADERS"}],"opts":{"setvar":[{"col":"tx","value":"%{rule.msg}","key":"msg"},{"value":"%{tx.warning_anomaly_score}","col":"tx","inc":1,"key":"anomaly_score"},{"col":"tx","value":"%{matched_var}","key":"%{rule"}]},"action":"DENY","pattern":"^bytes=(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,\\s?(\\d+)?\\-(\\d+)?\\,","operator":"REGEX","id":"958231"},{"opts":{"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"value":"%{tx.warning_anomaly_score}","col":"tx","key":"anomaly_score","inc":1},{"value":"%{matched_var}","col":"tx","key":"%{rule"}]},"action":"DENY","operator":"REGEX","pattern":"\\b(keep-alive|close),\\s?(keep-alive|close)\\b","id":"958295","description":"Multiple/Conflicting Connection Header Data Found.","logdata":"%{matched_var}","vars":[{"parse":{"specific":"Connection"},"type":"REQUEST_HEADERS"}]},{"description":"URL Encoding Abuse Attack Attempt","action":"CHAIN","vars":[{"type":"REQUEST_URI"}],"id":"950107","pattern":"\\%((?!$|\\W)|[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})","operator":"REGEX"},{"action":"DENY","opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"value":"%{tx.warning_anomaly_score}","col":"tx","inc":1,"key":"anomaly_score"},{"key":"%{rule","value":"%{matched_var}","col":"tx"}]},"vars":[{"type":"REQUEST_URI"}],"id":"950107","pattern":"@validateUrlEncoding","operator":"REGEX"},{"description":"Multiple URL Encoding Detected","vars":[{"type":"REQUEST_ARGS","parse":{"values":1}}],"opts":{"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"col":"tx","value":"%{tx.warning_anomaly_score}","key":"anomaly_score","inc":1},{"value":"%{matched_var}","col":"tx","key":"%{rule"}]},"action":"DENY","pattern":"\\%((?!$|\\W)|[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})","id":"950109","operator":"REGEX"},{"description":"UTF8 Encoding Abuse Attack Attempt","action":"CHAIN","vars":[{"storage":1,"type":"TX","parse":{"specific":"CRS_VALIDATE_UTF8_ENCODING"}}],"id":"950801","operator":"EQUALS","pattern":1},{"opts":{"setvar":[{"col":"tx","value":"%{rule.msg}","key":"msg"},{"value":"%{tx.warning_anomaly_score}","col":"tx","key":"anomaly_score","inc":1},{"value":"%{matched_var}","col":"tx","key":"%{rule"}]},"action":"DENY","id":"950801","operator":"REGEX","pattern":"@validateUtf8Encoding","vars":[{"type":"URI"},{"type":"REQUEST_ARGS","parse":{"values":1}},{"parse":{"keys":1},"type":"REQUEST_ARGS"}]},{"description":"Unicode Full/Half Width Abuse Attack Attempt","vars":[{"type":"REQUEST_URI"},{"type":"REQUEST_BODY"}],"pattern":"\\%u[fF]{2}[0-9a-fA-F]{2}","id":"950116","operator":"REGEX","action":"DENY","opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"key":"anomaly_score","inc":1,"col":"tx","value":"%{tx.warning_anomaly_score}"},{"value":"%{matched_var}","col":"tx","key":"%{rule"}]}},{"op_negated":1,"action":"DENY","vars":[{"unconditional":1}],"id":"BEGIN_HOST_CHECK"},{"vars":[{"type":"REQUEST_HEADERS","length":1,"parse":{"specific":"Host"}}],"description":"Request Missing a Host Header","skip_after":"END_HOST_CHECK","pattern":0,"id":"960008","operator":"EQUALS","action":"DENY","opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"key":"anomaly_score","inc":1,"value":"%{tx.warning_anomaly_score}","col":"tx"},{"key":"%{rule","col":"tx","value":"%{matched_var}"}]}},{"description":"Empty Host Header","vars":[{"parse":{"specific":"Host"},"type":"REQUEST_HEADERS"}],"action":"DENY","opts":{"setvar":[{"col":"tx","value":"%{rule.msg}","key":"msg"},{"col":"tx","value":"%{tx.warning_anomaly_score}","key":"anomaly_score","inc":1},{"key":"%{rule","value":"%{matched_var}","col":"tx"}]},"id":"960007","operator":"REGEX","pattern":"^$"},{"vars":[{"unconditional":1}],"id":"END_HOST_CHECK","action":"DENY","op_negated":1},{"id":"BEGIN_ACCEPT_CHECK","vars":[{"unconditional":1}],"op_negated":1,"action":"DENY"},{"description":"Request Missing an Accept Header","vars":[{"type":"METHOD"}],"action":"CHAIN","pattern":"!^OPTIONS$","operator":"REGEX","id":"960015"},{"skip_after":"END_ACCEPT_CHECK","vars":[{"parse":{"specific":"Accept"},"length":1,"type":"REQUEST_HEADERS"}],"operator":"EQUALS","id":"960015","pattern":0,"opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"inc":1,"key":"anomaly_score","value":"%{tx.notice_anomaly_score}","col":"tx"},{"value":"%{matched_var}","col":"tx","key":"%{rule"}]},"action":"DENY"},{"vars":[{"type":"METHOD"}],"operator":"REGEX","id":"960021","pattern":"!^OPTIONS$","action":"CHAIN","description":"Request Has an Empty Accept Header"},{"id":"960021","pattern":"^$","operator":"REGEX","vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"Accept"}}],"action":"DENY","opts":{"setvar":[{"col":"tx","value":"%{rule.msg}","key":"msg"},{"value":"%{tx.notice_anomaly_score}","col":"tx","key":"anomaly_score","inc":1},{"col":"tx","value":"%{matched_var}","key":"%{rule"}]}},{"op_negated":1,"action":"DENY","vars":[{"unconditional":1}],"id":"END_ACCEPT_CHECK"},{"action":"DENY","op_negated":1,"vars":[{"unconditional":1}],"id":"BEGIN_UA_CHECK"},{"opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"inc":1,"key":"anomaly_score","col":"tx","value":"%{tx.notice_anomaly_score}"},{"key":"%{rule","col":"tx","value":"%{matched_var}"}]},"action":"DENY","pattern":0,"id":"960009","operator":"EQUALS","vars":[{"parse":{"specific":"User-Agent"},"type":"REQUEST_HEADERS","length":1}],"description":"Request Missing a User Agent Header","skip_after":"END_UA_CHECK"},{"description":"Empty User Agent Header","vars":[{"parse":{"specific":"User-Agent"},"type":"REQUEST_HEADERS"}],"opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"key":"anomaly_score","inc":1,"col":"tx","value":"%{tx.notice_anomaly_score}"},{"key":"%{rule","col":"tx","value":"%{matched_var}"}]},"action":"DENY","operator":"REGEX","pattern":"^$","id":"960006"},{"vars":[{"unconditional":1}],"id":"END_UA_CHECK","op_negated":1,"action":"DENY"},{"vars":[{"parse":{"specific":"Content-Type"},"type":"REQUEST_HEADERS","length":1}],"pattern":0,"id":"960904","operator":"EQUALS","action":"CHAIN","description":"Request Containing Content, but Missing Content-Type header"},{"opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"inc":1,"key":"anomaly_score","col":"tx","value":"%{tx.notice_anomaly_score}"},{"col":"tx","value":"%{matched_var}","key":"%{rule"}]},"action":"DENY","operator":"REGEX","id":"960904","pattern":"!^0$","vars":[{"parse":{"specific":"Content-Length"},"type":"REQUEST_HEADERS"}]},{"logdata":"%{matched_var}","vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"Host"}}],"description":"Host header is a numeric IP address","opts":{"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"value":"%{tx.warning_anomaly_score}","col":"tx","key":"anomaly_score","inc":1},{"value":"%{matched_var}","col":"tx","key":"%{rule"}]},"action":"DENY","id":"960017","operator":"REGEX","pattern":"^[\\d.:]+$"},{"description":"HTTP/1.1 POST request missing Content-Length Header and missing Transfer-Encoding header.","operator":"REGEX","id":null,"pattern":"^POST$","vars":[{"type":"METHOD"}],"action":"DENY"},{"pattern":"^HTTP/1\\.1$","id":null,"operator":"REGEX","vars":[{"type":"PROTOCOL"}],"action":"CHAIN"},{"action":"CHAIN","operator":"EQUALS","id":null,"pattern":0,"vars":[{"length":1,"type":"REQUEST_HEADERS","parse":{"specific":"Transfer-Encoding"}}]},{"operator":"EQUALS","id":null,"pattern":0,"vars":[{"parse":{"specific":"Content-Length"},"type":"REQUEST_HEADERS","length":1}],"action":"DENY"},{"vars":[{"parse":{"specific":"ARG_NAME_LENGTH"},"length":1,"storage":1,"type":"TX"}],"id":"960209","operator":"EQUALS","pattern":1,"action":"CHAIN","description":"Argument name too long"},{"opts":{"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"col":"tx","value":"%{tx.notice_anomaly_score}","key":"anomaly_score","inc":1},{"key":"%{rule","col":"tx","value":"%{matched_var}"}],"transform":["length"]},"action":"DENY","operator":"GREATER","id":"960209","pattern":"%{tx.arg_name_length}","vars":[{"parse":{"keys":1},"type":"REQUEST_ARGS"}]},{"id":"960208","operator":"EQUALS","pattern":1,"vars":[{"type":"TX","storage":1,"length":1,"parse":{"specific":"ARG_LENGTH"}}],"action":"CHAIN","description":"Argument value too long"},{"action":"DENY","opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"key":"anomaly_score","inc":1,"value":"%{tx.notice_anomaly_score}","col":"tx"},{"col":"tx","value":"%{matched_var}","key":"%{rule"}],"transform":["length"]},"operator":"GREATER","id":"960208","pattern":"%{tx.arg_length}","vars":[{"type":"REQUEST_ARGS","parse":{"values":1}}]},{"description":"Too many arguments in request","id":"960335","operator":"EQUALS","pattern":1,"vars":[{"storage":1,"length":1,"type":"TX","parse":{"specific":"MAX_NUM_ARGS"}}],"action":"CHAIN"},{"id":"960335","pattern":"%{tx.max_num_args}","operator":"GREATER","vars":[{"parse":{"values":1},"type":"REQUEST_ARGS","length":1}],"opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"value":"%{tx.notice_anomaly_score}","col":"tx","inc":1,"key":"anomaly_score"},{"col":"tx","value":"%{matched_var}","key":"%{rule"}]},"action":"DENY"},{"description":"Uploaded file size too large","id":"960342","operator":"EQUALS","pattern":1,"vars":[{"parse":{"specific":"MAX_FILE_SIZE"},"storage":1,"length":1,"type":"TX"}],"action":"CHAIN"},{"vars":[{"parse":{"specific":"Content-Type"},"type":"REQUEST_HEADERS"}],"operator":"REGEX","id":"960342","pattern":"^multipart/form-data","action":"CHAIN","opts":{"parsepattern":1}},{"vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"Content-Length"}}],"pattern":"%{tx.max_file_size}","id":"960342","operator":"GREATER","action":"DENY","opts":{"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"col":"tx","value":"%{tx.notice_anomaly_score}","key":"anomaly_score","inc":1},{"key":"%{rule","value":"%{matched_var}","col":"tx"}]}},{"description":"Method is not allowed by policy","vars":[{"type":"METHOD"}],"logdata":"%{matched_var}","op_negated":1,"operator":"STR_EXISTS","id":"960032","pattern":"%{tx.allowed_methods}","opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"value":"%{tx.warning_anomaly_score}","col":"tx","key":"anomaly_score","inc":1},{"col":"tx","value":"%{matched_var}","key":"%{rule"}],"parsepattern":1},"action":"DENY"},{"description":"Request content type is not allowed by policy","logdata":"%{matched_var}","vars":[{"type":"METHOD"}],"action":"CHAIN","id":"960010","pattern":"!^(?:GET|HEAD|PROPFIND|OPTIONS)$","operator":"REGEX"},{"action":"CHAIN","id":"960010","pattern":"^([^;\\s]+)","operator":"REGEX","vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"Content-Type"}}]},{"opts":{"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"value":"%{tx.critical_anomaly_score}","col":"tx","inc":1,"key":"anomaly_score"},{"col":"tx","value":"%{matched_var}","key":"%{rule"}]},"action":"DENY","pattern":"!^%{tx.allowed_request_content_type}$","id":"960010","operator":"REGEX","vars":[{"parse":{"specific":"0"},"type":"TX","storage":1}]},{"opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"key":"anomaly_score","inc":1,"value":"%{tx.warning_anomaly_score}","col":"tx"},{"col":"tx","value":"%{matched_var}","key":"%{rule"}],"parsepattern":1},"action":"DENY","id":"960034","pattern":"%{tx.allowed_http_versions}","operator":"STR_EXISTS","description":"HTTP protocol version is not allowed by policy","logdata":"%{matched_var}","op_negated":1,"vars":[{"type":"PROTOCOL"}]},{"operator":"REGEX","id":"960035","pattern":"\\.(.*)$","action":"CHAIN","opts":{"transform":["lowercase"],"setvar":[{"value":".%{tx.1}/","col":"tx","key":"extension"}]},"description":"URL file extension is restricted by policy","vars":[{"type":"REQUEST_BASENAME"}],"logdata":"%{TX.0}"},{"action":"DENY","opts":{"parsepattern":1,"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"key":"anomaly_score","inc":1,"value":"%{tx.warning_anomaly_score}","col":"tx"},{"value":"%{matched_var}","col":"tx","key":"%{rule"}]},"id":"960035","operator":"STR_EXISTS","pattern":"%{tx.restricted_extensions}","vars":[{"storage":1,"type":"TX","parse":{"specific":"EXTENSION"}}]},{"pattern":"^(.*)$","id":"960038","operator":"REGEX","opts":{"setvar":[{"col":"tx","value":"/%{tx.0}/","key":"header_name"}]},"action":"CHAIN","description":"HTTP header is restricted by policy","vars":[{"parse":{"keys":1},"type":"REQUEST_HEADERS"}],"logdata":"%{matched_var}"},{"vars":[{"parse":{"specific":"HEADER_NAME"},"type":"TX","storage":1}],"id":"960038","operator":"STR_EXISTS","pattern":"%{tx.restricted_headers}","opts":{"parsepattern":1,"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"key":"anomaly_score","inc":1,"value":"%{tx.warning_anomaly_score}","col":"tx"},{"col":"tx","value":"%{matched_var}","key":"%{rule"}]},"action":"DENY"},{"operator":"PM","id":"990002","pattern":["grabber","cgichk","bsqlbf","mozilla/4.0 (compatible)","sqlmap","mozilla/4.0 (compatible; msie 6.0; win32)","mozilla/5.0 sf//","nessus","arachni","metis","sql power injector","bilbo","absinthe","black widow","n-stealth","brutus","webtrends security analyzer","netsparker","python-httplib2","jaascois","pmafind",".nasl","nsauditor","paros","dirbuster","pangolin","nmap nse","sqlninja","nikto","webinspect","blackwidow","grendel-scan","havij","w3af","hydra"],"action":"DENY","opts":{"transform":["lowercase"],"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"key":"anomaly_score","inc":1,"value":"%{tx.critical_anomaly_score}","col":"tx"},{"key":"%{rule","col":"tx","value":"%{matched_var}"}]},"vars":[{"parse":{"specific":"User-Agent"},"type":"REQUEST_HEADERS"}],"logdata":"%{matched_var}","description":"Request Indicates a Security Scanner Scanned the Site"},{"id":"990901","pattern":"\\bacunetix-product\\b","operator":"REGEX","opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"value":"%{tx.critical_anomaly_score}","col":"tx","key":"anomaly_score","inc":1},{"value":"%{matched_var}","col":"tx","key":"%{rule"}],"transform":["lowercase"]},"action":"DENY","vars":[{"parse":{"keys":1},"type":"REQUEST_HEADERS"}],"logdata":"%{matched_var}","description":"Request Indicates a Security Scanner Scanned the Site"},{"opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"inc":1,"key":"anomaly_score","value":"%{tx.critical_anomaly_score}","col":"tx"},{"col":"tx","value":"%{matched_var}","key":"%{rule"}],"transform":["lowercase"]},"action":"DENY","id":"990902","operator":"PM","pattern":["nessustest","appscan_fingerprint"],"logdata":"%{matched_var}","vars":[{"type":"URI"}],"description":"Request Indicates a Security Scanner Scanned the Site"},{"action":"CHAIN","operator":"PM","id":"990012","pattern":["webmole","wisenutbot","prowebwalker","hanzoweb","email","toata dragostea mea pentru diavola","gameBoy, powered by nintendo","missigua","poe-component-client","emailsiphon","adsarobot","under the rainbow 2.","nessus","floodgate","email extractor","webaltbot","contactbot/","butch__2.1.1","pe 1.4","indy library","autoemailspider","mozilla/3.mozilla/2.01","fantombrowser","digout4uagent","panscient.com","telesoft","; widows","converacrawler","www.weblogs.com","murzillo compatible","isc systems irc search 2.1","emailmagnet","microsoft url control","datacha0s","emailwolf","production bot","sitesnagger","webbandit","web by mail","faxobot","grub crawler","jakarta","eirgrabber","webemailextrac","extractorpro","attache","educate search vxb","8484 boston project","franklin locator","nokia-waptoolkit","mailto:craftbot@yahoo.com","full web bot","pcbrowser","psurf","user-Agent","pleasecrawl/1.","kenjin spider","gecko/2525","no browser","webster pro","wep Search 00","grub-client","fastlwspider","this is an exploit","contentsmartz","teleport pro","dts agent","nikto","morzilla","via","atomic_email_hunter","program shareware 1.0.","ecollector","emailcollect","china local browse 2.","backdoor","stress test","foobar/","emailreaper","xmlrpc exploit","compatible ; msie","s.t.a.l.k.e.r.","compatible-","webvulnscan","nameofagent","copyrightcheck","advanced email extractor","surveybot","compatible ;.","searchbot admin@google","wordpress/4.01","webemailextract","larbin@unspecified","turing machine","zeus","windows-update-agent","morfeus fucking scanner","user-agent:","voideye","mosiac 1","chinaclaw","newt activeX; win32","web downloader","safexplorer tl","agdm79@mail.ru","cheesebot","hhjhj@yahoo","fiddler","psycheclone","microsoft internet explorer/5.0","core-project/1","atspider","copyguard","neuralbot/0.2","wordpress hash grabber","amiga-aweb/3.4","packrat","rsync","crescent internet toolpak","security scan","vadixbot","concealed defense","a href=","bwh3_user_agent","internet ninja","microsoft url","emailharvest","shai","wisebot","internet exploiter sux","wells search ii","webroot","digimarc webreader","botversion","black hole","w3mir","pmafind","athens","hl_ftien_spider"," injection","takeout","eo browse","cherrypicker","internet-exprorer"],"logdata":"%{TX.0}","vars":[{"parse":{"specific":"User-Agent"},"type":"REQUEST_HEADERS"}],"description":"Rogue web site crawler"},{"opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"col":"tx","value":"%{tx.warning_anomaly_score}","inc":1,"key":"anomaly_score"},{"key":"%{rule","value":"%{matched_var}","col":"tx"}]},"action":"DENY","vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"User-Agent"}}],"id":"990012","operator":"REGEX","pattern":"(?i:(?:c(?:o(?:n(?:t(?:entsmartz|actbot/)|cealed defense|veracrawler)|mpatible(?: ;(?: msie|\\.)|-)|py(?:rightcheck|guard)|re-project/1.0)|h(?:ina(?: local browse 2\\.|claw)|e(?:rrypicker|esebot))|rescent internet toolpak)|w(?:e(?:b(?: (?:downloader|by mail)|(?:(?:altb|ro)o|bandi)t|emailextract?|vulnscan|mole)|lls search ii|p Search 00)|i(?:ndows(?:-update-agent)|se(?:nut)?bot)|ordpress(?: hash grabber|\\/4\\.01)|3mir)|m(?:o(?:r(?:feus fucking scanner|zilla)|zilla\\/3\\.mozilla\\/2\\.01$|siac 1.)|i(?:crosoft (?:internet explorer\\/5\\.0$|url control)|ssigua)|ailto:craftbot\\@yahoo\\.com|urzillo compatible)|p(?:ro(?:gram shareware 1\\.0\\.|duction bot|webwalker)|a(?:nscient\\.com|ckrat)|oe-component-client|s(?:ycheclone|urf)|leasecrawl\\/1\\.|cbrowser|e 1\\.4|mafind)|e(?:mail(?:(?:collec|harves|magne)t|(?: extracto|reape)r|(siphon|spider)|siphon|wolf)|(?:collecto|irgrabbe)r|ducate search vxb|xtractorpro|o browse)|t(?:(?: ?h ?a ?t ?' ?s g ?o ?t ?t ?a ? h ?u ?r ?|his is an exploi|akeou)t|oata dragostea mea pentru diavola|ele(?:port pro|soft)|uring machine)|a(?:t(?:(?:omic_email_hunt|spid)er|tache|hens)|d(?:vanced email extractor|sarobot)|gdm79\\@mail\\.ru|miga-aweb\\/3\\.4|utoemailspider| href=)|^(?:(google|i?explorer?\\.exe|(ms)?ie( [0-9.]+)?\\ ?(compatible( browser)?)?)$|www\\.weblogs\\.com|(?:jakart|vi)a|microsoft url|user-Agent)|s(?:e(?:archbot admin@google.com|curity scan)|(?:tress tes|urveybo)t|\\.t\\.a\\.l\\.k\\.e\\.r\\.|afexplorer tl|itesnagger|hai)|n(?:o(?:kia-waptoolkit.* googlebot.*googlebot| browser)|e(?:(?:wt activeX; win3|uralbot\\/0\\.)2|ssus)|ameofagent|ikto)|f(?:a(?:(?:ntombrows|stlwspid)er|xobot)|(?:ranklin locato|iddle)r|ull web bot|loodgate|oobar/)|i(?:n(?:ternet(?: (?:exploiter sux|ninja)|-exprorer)|dy library)|sc systems irc search 2\\.1)|g(?:ameBoy, powered by nintendo|rub(?: crawler|-client)|ecko\\/25)|(myie2|libwen-us|murzillo compatible|webaltbot|wisenutbot)|b(?:wh3_user_agent|utch__2\\.1\\.1|lack hole|ackdoor)|d(?:ig(?:imarc webreader|out4uagent)|ts agent)|(?:(script|sql) inject|$botname/$botvers)ion|(msie .+; .*windows xp|compatible \\; msie)|h(?:l_ftien_spider|hjhj@yahoo|anzoweb)|(?:8484 boston projec|xmlrpc exploi)t|u(?:nder the rainbow 2\\.|ser-agent:)|(sogou develop spider|sohu agent)|(?:(?:d|e)browse|demo bot)|zeus(?: .*webster pro)?|[a-z]surf[0-9][0-9]|v(?:adixbot|oideye)|larbin@unspecified|\\bdatacha0s\\b|kenjin spider|; widows|rsync|\\\\\\r))"},{"vars":[{"unconditional":1}],"id":"END_ROBOT_CHECK","action":"DENY","op_negated":1},{"action":"DENY","op_negated":1,"vars":[{"unconditional":1}],"id":"END_COMMAND_INJECTION1"},{"action":"DENY","opts":{"setvar":[{"key":"anomaly_score","inc":1,"value":"%{tx.warning_anomaly_score}","col":"tx"},{"col":"tx","value":"%{rule.msg}","key":"msg"},{"col":"tx","value":"%{tx.0}","key":"%{rule"}]},"pattern":"\\W{4,}","id":"960024","operator":"REGEX","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"parse":{"values":1},"type":"REQUEST_ARGS"}],"description":"Meta-Character Anomaly Detection Alert - Repetative Non-Word Characters"},{"id":"END_CF_INJECTION","vars":[{"unconditional":1}],"op_negated":1,"action":"DENY"},{"op_negated":1,"action":"DENY","id":"END_LDAP_INJECTION","vars":[{"unconditional":1}]},{"op_negated":1,"action":"DENY","id":"END_SSI_INJECTION","vars":[{"unconditional":1}]},{"description":"Remote File Inclusion Attack","vars":[{"parse":{"values":1},"type":"REQUEST_ARGS"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","pattern":"^(?i)(?:ht|f)tps?:\\/\\/(\\d{1,3}\\.\\d{1,3}\\.\\d{1,3}\\.\\d{1,3})","operator":"REGEX","id":"950117","opts":{"setvar":[{"col":"tx","value":"%{rule.msg}","key":"msg"},{"inc":1,"key":"anomaly_score","col":"tx","value":"%{tx.critical_anomaly_score}"},{"key":"%{rule","col":"tx","value":"%{tx.0}"}]},"action":"DENY"},{"opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"col":"tx","value":"%{tx.critical_anomaly_score}","key":"anomaly_score","inc":1},{"value":"%{tx.0}","col":"tx","key":"%{rule"}]},"action":"DENY","operator":"REGEX","pattern":"(?i:(\\binclude\\s*\\([^)]*|mosConfig_absolute_path|_CONF\\[path\\]|_SERVER\\[DOCUMENT_ROOT\\]|GALLERY_BASEDIR|path\\[docroot\\]|appserv_root|config\\[root_dir\\])=(ht|f)tps?:\\/\\/)","id":"950118","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"QUERY_STRING"},{"type":"REQUEST_BODY"}],"description":"Remote File Inclusion Attack"},{"vars":[{"parse":{"values":1},"type":"REQUEST_ARGS"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","description":"Remote File Inclusion Attack","id":"950119","operator":"REGEX","pattern":"^(?i)(?:ft|htt)ps?(.*?)\\?+$","opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"inc":1,"key":"anomaly_score","col":"tx","value":"%{tx.critical_anomaly_score}"},{"key":"%{rule","col":"tx","value":"%{tx.0}"}]},"action":"DENY"},{"id":"950120","operator":"REGEX","pattern":"^(?:ht|f)tps?://(.*)$","action":"CHAIN","vars":[{"type":"REQUEST_ARGS","parse":{"values":1}}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","description":"Possible Remote File Inclusion (RFI) Attack: Off-Domain Reference/Link"},{"vars":[{"parse":{"specific":"1"},"storage":1,"type":"TX"}],"id":"950120","pattern":"^%{request_headers.host}","operator":"REGEX","action":"DENY","op_negated":1,"opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"inc":1,"key":"anomaly_score","value":"%{tx.critical_anomaly_score}","col":"tx"},{"key":"%{rule","value":"%{tx.1}","col":"tx"}],"parsepattern":1}},{"vars":[{"storage":1,"type":"TX","parse":{"specific":"PM_SCORE"}}],"skip_after":"END_PM_CHECK","pattern":0,"operator":"EQUALS","id":"981134","action":"IGNORE","opts":{"nolog":1}},{"action":"DENY","op_negated":1,"opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"value":"%{tx.critical_anomaly_score}","col":"tx","key":"anomaly_score","inc":1},{"col":"tx","value":"%{tx.0}","key":"%{rule"}],"parsepattern":1},"vars":[{"parse":{"specific":"1"},"type":"TX","storage":1}],"pattern":"^%{request_headers.host}","id":null,"operator":"REGEX"},{"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"REQUEST_ARGS","parse":{"keys":1}}],"description":"Session Fixation","action":"CHAIN","opts":{"transform":["lowercase"]},"pattern":["jsessionid","aspsessionid","asp.net_sessionid","phpsession","phpsessid","weblogicsession","session_id","session-id","cfid","cftoken","cfsid","jservsession","jwsession"],"id":"950000","operator":"PM"},{"opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"col":"tx","value":"%{tx.critical_anomaly_score}","key":"anomaly_score","inc":1},{"key":"%{rule","col":"tx","value":"%{tx.0}"}]},"action":"DENY","pattern":0,"id":"950000","operator":"EQUALS","vars":[{"parse":{"specific":"Referer"},"type":"REQUEST_HEADERS","length":1}]},{"vars":[{"unconditional":1}],"id":"END_SESSION_FIXATION","op_negated":1,"action":"DENY"},{"action":"DENY","op_negated":1,"vars":[{"unconditional":1}],"id":"END_FILE_INJECTION"},{"op_negated":1,"action":"DENY","vars":[{"unconditional":1}],"id":"END_COMMAND_ACCESS"},{"action":"DENY","op_negated":1,"vars":[{"unconditional":1}],"id":"END_COMMAND_INJECTION"},{"pattern":["allow_url_include=","safe_mode=","suhosin.simulation=","disable_functions=","open_basedir=","auto_prepend_file=","php://input"],"operator":"PM","id":"958977","action":"DENY","opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"key":"anomaly_score","inc":1,"col":"tx","value":"%{tx.critical_anomaly_score}"},{"key":"%{rule","value":"%{tx.0}","col":"tx"}],"transform":["lowercase"]},"vars":[{"type":"QUERY_STRING"}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","description":"PHP Injection Attack"},{"id":"END_PM_CHECK","vars":[{"unconditional":1}],"action":"DENY","op_negated":1},{"action":"IGNORE","opts":{"nolog":1,"setvar":[{"value":"1","col":"tx","key":"sqli_select_statement_count","inc":1},{"col":"tx","value":"1","key":"sql_injection_score","inc":1}]},"vars":[{"storage":1,"type":"TX","parse":{"specific":"SQLI_SELECT_STATEMENT"}}],"pattern":"\bselect\b","id":"981301","operator":"REGEX"},{"action":"IGNORE","opts":{"nolog":1,"setvar":[{"inc":1,"key":"sqli_select_statement_count","col":"tx","value":"1"},{"inc":1,"key":"sql_injection_score","value":"1","col":"tx"}]},"vars":[{"type":"TX","storage":1,"parse":{"specific":"SQLI_SELECT_STATEMENT"}}],"pattern":"\bshow\b","id":"981302","operator":"REGEX"},{"action":"IGNORE","opts":{"setvar":[{"col":"tx","value":"1","key":"sqli_select_statement_count","inc":1},{"value":"1","col":"tx","key":"sql_injection_score","inc":1}],"nolog":1},"pattern":"\btop\b","id":"981303","operator":"REGEX","vars":[{"type":"TX","storage":1,"parse":{"specific":"SQLI_SELECT_STATEMENT"}}]},{"action":"IGNORE","opts":{"nolog":1,"setvar":[{"value":"1","col":"tx","key":"sqli_select_statement_count","inc":1},{"value":"1","col":"tx","key":"sql_injection_score","inc":1}]},"pattern":"\bdistinct\b","id":"981304","operator":"REGEX","vars":[{"parse":{"specific":"SQLI_SELECT_STATEMENT"},"storage":1,"type":"TX"}]},{"id":"981305","pattern":"\bfrom\b","operator":"REGEX","vars":[{"parse":{"specific":"SQLI_SELECT_STATEMENT"},"type":"TX","storage":1}],"opts":{"nolog":1,"setvar":[{"col":"tx","value":"1","key":"sqli_select_statement_count","inc":1},{"col":"tx","value":"1","inc":1,"key":"sql_injection_score"}]},"action":"IGNORE"},{"pattern":"\bdual\b","id":"981306","operator":"REGEX","vars":[{"parse":{"specific":"SQLI_SELECT_STATEMENT"},"type":"TX","storage":1}],"opts":{"setvar":[{"inc":1,"key":"sqli_select_statement_count","value":"1","col":"tx"},{"inc":1,"key":"sql_injection_score","col":"tx","value":"1"}],"nolog":1},"action":"IGNORE"},{"opts":{"nolog":1,"setvar":[{"value":"1","col":"tx","inc":1,"key":"sqli_select_statement_count"},{"col":"tx","value":"1","key":"sql_injection_score","inc":1}]},"action":"IGNORE","vars":[{"parse":{"specific":"SQLI_SELECT_STATEMENT"},"type":"TX","storage":1}],"operator":"REGEX","id":"981307","pattern":"\bwhere\b"},{"id":"981308","pattern":"group by","operator":"STR_CONTAINS","vars":[{"parse":{"specific":"SQLI_SELECT_STATEMENT"},"storage":1,"type":"TX"}],"opts":{"parsepattern":1,"nolog":1,"setvar":[{"key":"sqli_select_statement_count","inc":1,"value":"1","col":"tx"},{"inc":1,"key":"sql_injection_score","value":"1","col":"tx"}]},"action":"IGNORE"},{"id":"981309","operator":"STR_CONTAINS","pattern":"order by","vars":[{"parse":{"specific":"SQLI_SELECT_STATEMENT"},"storage":1,"type":"TX"}],"action":"IGNORE","opts":{"parsepattern":1,"setvar":[{"col":"tx","value":"1","key":"sqli_select_statement_count","inc":1},{"value":"1","col":"tx","key":"sql_injection_score","inc":1}],"nolog":1}},{"action":"IGNORE","opts":{"nolog":1,"setvar":[{"col":"tx","value":"1","inc":1,"key":"sqli_select_statement_count"},{"inc":1,"key":"sql_injection_score","value":"1","col":"tx"}]},"vars":[{"parse":{"specific":"SQLI_SELECT_STATEMENT"},"storage":1,"type":"TX"}],"pattern":"\bhaving\b","id":"981310","operator":"REGEX"},{"opts":{"setvar":[{"key":"sqli_select_statement_count","inc":1,"value":"1","col":"tx"},{"key":"sql_injection_score","inc":1,"col":"tx","value":"1"}],"nolog":1},"action":"IGNORE","vars":[{"type":"TX","storage":1,"parse":{"specific":"SQLI_SELECT_STATEMENT"}}],"id":"981311","operator":"REGEX","pattern":"\blimit\b"},{"vars":[{"parse":{"specific":"SQLI_SELECT_STATEMENT"},"storage":1,"type":"TX"}],"id":"981312","operator":"REGEX","pattern":"\boffset\b","action":"IGNORE","opts":{"setvar":[{"col":"tx","value":"1","inc":1,"key":"sqli_select_statement_count"},{"key":"sql_injection_score","inc":1,"col":"tx","value":"1"}],"nolog":1}},{"id":"981313","operator":"REGEX","pattern":"\bunion\b","vars":[{"parse":{"specific":"SQLI_SELECT_STATEMENT"},"type":"TX","storage":1}],"action":"IGNORE","opts":{"setvar":[{"key":"sqli_select_statement_count","inc":1,"col":"tx","value":"1"},{"value":"1","col":"tx","inc":1,"key":"sql_injection_score"}],"nolog":1}},{"action":"IGNORE","opts":{"parsepattern":1,"setvar":[{"col":"tx","value":"1","key":"sqli_select_statement_count","inc":1},{"key":"sql_injection_score","inc":1,"col":"tx","value":"1"}],"nolog":1},"vars":[{"type":"TX","storage":1,"parse":{"specific":"SQLI_SELECT_STATEMENT"}}],"operator":"STR_CONTAINS","id":"981314","pattern":"union all"},{"vars":[{"parse":{"specific":"SQLI_SELECT_STATEMENT"},"type":"TX","storage":1}],"id":"981315","operator":"STR_CONTAINS","pattern":"rownum as","action":"IGNORE","opts":{"setvar":[{"col":"tx","value":"1","key":"sqli_select_statement_count","inc":1},{"value":"1","col":"tx","key":"sql_injection_score","inc":1}],"nolog":1,"parsepattern":1}},{"vars":[{"type":"TX","storage":1,"parse":{"specific":"SQLI_SELECT_STATEMENT"}}],"id":"981316","operator":"STR_CONTAINS","pattern":"(case","action":"IGNORE","opts":{"parsepattern":1,"setvar":[{"col":"tx","value":"1","key":"sqli_select_statement_count","inc":1},{"col":"tx","value":"1","key":"sql_injection_score","inc":1}],"nolog":1}},{"pattern":3,"operator":"GREATER_EQ","id":"981317","opts":{"setvar":[{"inc":1,"key":"anomaly_score","col":"tx","value":"%{tx.warning_anomaly_score}"},{"inc":1,"key":"sql_injection_score","col":"tx","value":"1"},{"value":"%{rule.msg}","col":"tx","key":"msg"},{"value":"%{tx.0}","col":"tx","key":"%{rule"}]},"action":"DENY","vars":[{"storage":1,"type":"TX","parse":{"specific":"SQLI_SELECT_STATEMENT_COUNT"}}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","description":"SQL SELECT Statement Anomaly Detection Alert"},{"action":"DENY","opts":{"setvar":[{"value":"%{tx.warning_anomaly_score}","col":"tx","inc":1,"key":"anomaly_score"},{"key":"sql_injection_score","inc":1,"col":"tx","value":"1"},{"value":"%{rule.msg}","col":"tx","key":"msg"},{"value":"%{tx.0}","col":"tx","key":"%{rule"}]},"pattern":"([\\~\\!\\@\\#\\$\\%\\^\\&\\*\\(\\)\\-\\+\\=\\{\\}\\[\\]\\|\\:\\;\\\"\\'\\\\\\\\`\\<\\>].*?){8,}","operator":"REGEX","id":"981172","logdata":"Matched Data: %{TX.1} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"parse":{"values":1},"type":"COOKIES"},{"parse":{"ignore":"/__utm/"},"type":"COOKIES"},{"type":"COOKIES","parse":{"ignore":"/_pk_ref/"}},{"type":"COOKIES","parse":{"ignore":"/__utm/"}},{"type":"COOKIES","parse":{"ignore":"/_pk_ref/"}},{"parse":{"keys":1},"type":"COOKIES"}],"description":"Restricted SQL Character Anomaly Detection Alert - Total # of special characters exceeded"},{"vars":[{"type":"REQUEST_ARGS","parse":{"values":1}}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","description":"XSS Filter - Category 1: Script Tag Vector","operator":"REGEX","pattern":"(?i)(<script[^>]*>[\\s\\S]*?<\\/script[^>]*>|<script[^>]*>[\\s\\S]*?<\\/script[[\\s\\S]]*[\\s\\S]|<script[^>]*>[\\s\\S]*?<\\/script[\\s]*[\\s]|<script[^>]*>[\\s\\S]*?<\\/script|<script[^>]*>[\\s\\S]*?)","id":"973336","opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"key":"xss_score","inc":1,"col":"tx","value":"%{tx.critical_anomaly_score}"},{"key":"anomaly_score","inc":1,"col":"tx","value":"%{tx.critical_anomaly_score}"},{"value":"%{tx.0}","col":"tx","key":"%{rule"}],"transform":["html_decode"]},"action":"DENY"},{"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"parse":{"values":1},"type":"REQUEST_ARGS"}],"description":"XSS Filter - Category 2: Event Handler Vector","opts":{"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"inc":1,"key":"xss_score","col":"tx","value":"%{tx.critical_anomaly_score}"},{"col":"tx","value":"%{tx.critical_anomaly_score}","inc":1,"key":"anomaly_score"},{"value":"%{tx.0}","col":"tx","key":"%{rule"}],"transform":["html_decode"]},"action":"DENY","pattern":"(?i)([\\s\\\"'`;\\/0-9\\=]+on\\w+\\s*=)","id":"973337","operator":"REGEX"},{"vars":[{"type":"REQUEST_ARGS","parse":{"values":1}}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","description":"XSS Filter - Category 3: Javascript URI Vector","pattern":"(?i)((?:=|U\\s*R\\s*L\\s*\\()\\s*[^>]*\\s*S\\s*C\\s*R\\s*I\\s*P\\s*T\\s*:|&colon;|[\\s\\S]allowscriptaccess[\\s\\S]|[\\s\\S]src[\\s\\S]|[\\s\\S]data:text\\/html[\\s\\S]|[\\s\\S]xlink:href[\\s\\S]|[\\s\\S]base64[\\s\\S]|[\\s\\S]xmlns[\\s\\S]|[\\s\\S]xhtml[\\s\\S]|[\\s\\S]style[\\s\\S]|<style[^>]*>[\\s\\S]*?|[\\s\\S]@import[\\s\\S]|<applet[^>]*>[\\s\\S]*?|<meta[^>]*>[\\s\\S]*?|<object[^>]*>[\\s\\S]*?)","operator":"REGEX","id":"973338","action":"DENY","opts":{"setvar":[{"value":"%{rule.msg}","col":"tx","key":"msg"},{"inc":1,"key":"xss_score","col":"tx","value":"%{tx.critical_anomaly_score}"},{"col":"tx","value":"%{tx.critical_anomaly_score}","key":"anomaly_score","inc":1},{"value":"%{tx.0}","col":"tx","key":"%{rule"}],"transform":["html_decode"]}},{"skip_after":"END_XSS_CHECK","vars":[{"type":"TX","length":1,"storage":1,"parse":{"specific":"PM_XSS_SCORE"}}],"action":"IGNORE","opts":{"nolog":1},"operator":"EQUALS","pattern":0,"id":"981018"},{"id":"END_XSS_CHECK","vars":[{"unconditional":1}],"action":"DENY","op_negated":1},{"description":"Backdoor access","vars":[{"type":"REQUEST_HEADERS","parse":{"keys":1}}],"logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","pattern":"x_(?:key|file)\\b","id":"950110","operator":"REGEX","action":"DENY","opts":{"setvar":[{"key":"msg","value":"%{rule.msg}","col":"tx"},{"key":"trojan_score","inc":1,"value":"1","col":"tx"},{"value":"%{tx.critical_anomaly_score}","col":"tx","key":"anomaly_score","inc":1},{"value":"%{matched_var}","col":"tx","key":"%{rule"}],"transform":["lowercase"]}},{"action":"DENY","opts":{"setvar":[{"key":"msg","col":"tx","value":"%{rule.msg}"},{"key":"trojan_score","inc":1,"col":"tx","value":"1"},{"value":"%{tx.critical_anomaly_score}","col":"tx","inc":1,"key":"anomaly_score"},{"key":"%{rule","col":"tx","value":"%{matched_var}"}],"transform":["html_decode","lowercase"]},"pattern":"root\\.exe","id":"950921","operator":"REGEX","logdata":"Matched Data: %{TX.0} found within %{MATCHED_VAR_NAME}: %{MATCHED_VAR}","vars":[{"type":"URI"}],"description":"Backdoor access"},{"vars":[{"type":"REQUEST_LINE"}],"operator":"REGEX","id":"981020","pattern":"^GET /$","opts":{"nolog":1},"action":"CHAIN"},{"id":"981020","operator":"REGEX","pattern":"^(127\\.0\\.0\\.|\\:\\:)1$","vars":[{"type":"REMOTE_ADDR"}],"action":"CHAIN"},{"vars":[{"parse":{"specific":"'/PROTOCOL_VIOLATION\\\\\\/MISSING_HEADER/'"},"type":"TX","storage":1}],"id":"981020","operator":"REGEX","pattern":".*","opts":{"setvar":[{"col":"tx","value":"1","inc":1,"key":"missing_header"},{"key":"missing_header_%{tx","value":"%{matched_var_name}","col":"tx"}]},"action":"CHAIN"},{"action":"IGNORE","opts":{"setvar":[{"key":"%{tx","col":"!tx","value":null}]},"vars":[{"storage":1,"type":"TX","parse":{"specific":"'/MISSING_HEADER_/'"}}],"operator":"REGEX","id":"981020","pattern":"TX\\:(.*)"},{"action":"CHAIN","opts":{"nolog":1},"id":"981021","pattern":"^(GET /|OPTIONS \\*) HTTP/1.0$","operator":"REGEX","vars":[{"type":"REQUEST_LINE"}]},{"action":"CHAIN","id":"981021","operator":"REGEX","pattern":"^(127\\.0\\.0\\.|\\:\\:)1$","vars":[{"type":"REMOTE_ADDR"}]},{"vars":[{"parse":{"specific":"User-Agent"},"type":"REQUEST_HEADERS"}],"operator":"REGEX","id":"981021","pattern":"^.*\\(internal dummy connection\\)$","action":"CHAIN"},{"vars":[{"parse":{"specific":"'/PROTOCOL_VIOLATION\\\\\\/MISSING_HEADER/'"},"type":"TX","storage":1}],"id":"981021","operator":"REGEX","pattern":".*","opts":{"setvar":[{"key":"missing_header","inc":1,"col":"tx","value":"1"},{"key":"missing_header_%{tx","value":"%{matched_var_name}","col":"tx"}]},"action":"CHAIN"},{"action":"IGNORE","opts":{"setvar":[{"col":"!tx","value":null,"key":"%{tx"}]},"vars":[{"type":"TX","storage":1,"parse":{"specific":"'/MISSING_HEADER_/'"}}],"id":"981021","operator":"REGEX","pattern":"TX\\:(.*)"},{"action":"CHAIN","opts":{"parsepattern":1,"nolog":1},"pattern":"POST","id":"981022","operator":"EQUALS","vars":[{"type":"METHOD"}]},{"opts":{"parsepattern":1},"action":"CHAIN","vars":[{"parse":{"specific":"User-Agent"},"type":"REQUEST_HEADERS"}],"id":"981022","operator":"STR_CONTAINS","pattern":"Adobe Flash Player"},{"action":"CHAIN","operator":"REGEX","id":"981022","pattern":".*","vars":[{"type":"REQUEST_HEADERS","parse":{"specific":"X-Flash-Version"}}]},{"vars":[{"parse":{"specific":"Content-Type"},"type":"REQUEST_HEADERS"}],"pattern":"application/x-amf","id":"981022","operator":"STR_CONTAINS","action":"CHAIN","opts":{"parsepattern":1}},{"opts":{"setvar":[{"value":"1","col":"tx","inc":1,"key":"missing_header"},{"key":"missing_header_%{tx","col":"tx","value":"%{matched_var_name}"}]},"action":"CHAIN","vars":[{"parse":{"specific":"'/PROTOCOL_VIOLATION\\\\\\/MISSING_HEADER/'"},"storage":1,"type":"TX"}],"id":"981022","pattern":".*","operator":"REGEX"},{"id":"981022","operator":"REGEX","pattern":"TX\\:(.*)","vars":[{"storage":1,"type":"TX","parse":{"specific":"'/MISSING_HEADER_/'"}}],"opts":{"setvar":[{"key":"%{tx","value":null,"col":"!tx"},{"value":"-5","col":"tx","key":"anomaly_score"}]},"action":"IGNORE"},{"operator":"GREATER","id":"981176","pattern":0,"opts":{"setvar":[{"key":"inbound_tx_msg","col":"tx","value":"%{tx.msg}"},{"key":"inbound_anomaly_score","value":"%{tx.anomaly_score}","col":"tx"}]},"action":"CHAIN","vars":[{"parse":{"specific":"ANOMALY_SCORE"},"type":"TX","storage":1}],"logdata":"Last Matched Data: %{matched_var}","description":"Inbound Anomaly Score Exceeded (Total Score: %{TX.ANOMALY_SCORE}, SQLi=%{TX.SQL_INJECTION_SCORE}, XSS=%{TX.XSS_SCORE}): Last Matched Message: %{tx.msg}"},{"action":"CHAIN","vars":[{"storage":1,"type":"TX","parse":{"specific":"ANOMALY_SCORE"}}],"pattern":"%{tx.inbound_anomaly_score_level}","id":"981176","operator":"GREATER_EQ"},{"operator":"EQUALS","id":"981176","pattern":"on","vars":[{"storage":1,"type":"TX","parse":{"specific":"ANOMALY_SCORE_BLOCKING"}}],"action":"CHAIN","opts":{"parsepattern":1}},{"id":"981176","operator":"REGEX","pattern":"(.*)","vars":[{"type":"TX","storage":1,"parse":{"specific":"/^\\d+\\-/"}}],"action":"DENY"},{"vars":[{"unconditional":1}],"id":"END_IFRAME_CHECK","action":"DENY","op_negated":1},{"vars":[{"unconditional":1}],"id":"END_OUTBOUND_CHECK","action":"DENY","op_negated":1},{"vars":[{"unconditional":1}],"id":"END_CORRELATION","action":"DENY","op_negated":1}],"header_filter":[]}
